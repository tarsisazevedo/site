---
- hosts: web
  vars:
    - docroot: /var/www/html
  tasks:
    - name: Download Site
      when: gitinstalled|success
      git: repo=https://tarsisazevedo@bitbucket.org/tarsisazevedo/site-pessoal.git dest=/tmp/site
      register: sitedownloaded

    - name: Build Site
      when: hugoinstalled|success
      command: hugo --destination={{ docroot }} chdir=/tmp/site/site
      notify:
        - Reload Nginx

  handlers:
    - name: Reload Nginx
      service: name=nginx state=reloaded
